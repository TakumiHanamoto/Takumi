<h1>Srental</h1>
<h3>依頼一覧</h3>

<% if Requester %>
<%= button_to "new_order", new_order_path %>
<% end %>

<% if requester_signed_in? %>
<%= link_to "マイページへ", requester_path(current_requester.id) %>　
<% elsif student_signed_in? %>
<%= link_to "マイページへ", student_path(current_student.id) %>
<% end %>

<br>
<%= page_entries_info @orders %>
<div class="orders-container">
<% @orders.each do |o| %>
<div class="order">
    <a href="/requesters/<%= o.requester.id %>"><%= o.requester.name %></a>
    <%= o.title %>
    <%= o.body %>
    <%= o.created_at %>

    <% if requester_signed_in? %>
    <% if current_requester.already_liked?(o) %>
        <%= link_to order_like_path(id: o.id, order_id: o.id), method: :delete do %>
            <p>Cancell Like</p></i><%= o.likes.count %>
        <% end %>
    <% else %>
        <%= link_to order_likes_path(id: o.id, order_id: o.id), method: :post do %>
            <p>Like</p></i><%= o.likes.count %>
        <% end %>
    <% end %>
    <% else %>
        <p>Count of Like = </p></i><%= o.likes.count %>
    <% end %>

    <% if student_signed_in? %>
    　<% if current_student.already_received?(o) %>
        　<%= link_to order_receive_path(id: o.id, order_id: o.id), method: :delete do %>
        　<p>Cancell Receive</p><%= o.receives.count %>
        　<% end %>
    　<% else %>
        　<%= link_to order_receives_path(id: o.id, order_id: o.id), method: :post do %>
            　<p>Receive</p><%= o.receives.count %>
        　<% end %>
    　<% end %>
　　<% else %>
    　<p>Receiveの数 = </p><%= o.receives.count %>
　<% end %>

    <%= image_tag o.image_url, size: "250x200" if o.image? %>

    <% if requester_signed_in? && current_requester.id == o.requester_id %>
        <%= button_to "Details", order_path(o.id) %>
        <%= button_to "Edit", edit_order_path(o.id) %>
        <%= button_to "Delete", order_path(o.id), method: :delete %>
        <% end %> 
    

</div>
<% end %>
</div>
<%= paginate @orders %>

<br><br>
<% if Requester %>
<%= button_to 'Logout for requesters', destroy_requester_session_path, method: :delete %>
<% elsif Student %>
<%= button_to 'Logout for students', destroy_student_session_path, method: :delete %>
<% else %>
Are you an Admin?
<% end %>